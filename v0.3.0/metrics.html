



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="author" content="PyTorch-Ignite Contributors">
  <meta name="creator" content="PyTorch-Ignite Contributors">
  <meta name="publisher" content="PyTorch-Ignite Contributors">
  <meta name="generator" content="Sphinx 5.3.0">
  <meta name="description" content="High-level library to help with training and evaluating neural networks in PyTorch flexibly and transparently.">
  <meta name="keywords" content="pytorch, pytorch ignite, ignite, engine, events, handlers, metrics">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#ee4c2c">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@pytorch_ignite">
  <meta name="twitter:creator" content="@pytorch_ignite">
  <meta name="twitter:description" content="High-level library to help with training and evaluating neural networks in PyTorch flexibly and transparently.">
  <meta name="twitter:title" content="ignite.metrics &mdash; PyTorch-Ignite v0.3.0 Documentation">
  <meta name="twitter:image" content="https://raw.githubusercontent.com/pytorch/ignite/master/assets/logo/ignite_logo.png">
  <meta name="twitter:image:alt" content="PyTorch-Ignite logo">

  <meta property="og:title" content="ignite.metrics &mdash; PyTorch-Ignite v0.3.0 Documentation">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://pytorch.org/ignite/">
  <meta property="og:site_name" content="PyTorch-Ignite">
  <meta property="og:image" content="https://raw.githubusercontent.com/pytorch/ignite/master/assets/logo/ignite_logo.png">
  <meta property="og:image:alt" content="PyTorch-Ignite logo">
  <meta property="og:description" content="High-level library to help with training and evaluating neural networks in PyTorch flexibly and transparently.">

  <link rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin />

  
  <title>ignite.metrics &mdash; PyTorch-Ignite v0.3.0 Documentation</title>
  

  
  
    <link rel="shortcut icon" type="image/svg+xml" href="_static/ignite_logomark.svg"/>
  
  
  
    <link rel="canonical" href="https://pytorch.org/ignite/metrics.html"/>
  

  

  
  
    

  

  <link rel="preload" href="_static/css/theme.css" as="style" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="preload" href="_static/pygments.css" as="style" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="preload" href="_static/css/theme.css" as="style" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="preload" href="_static/copybutton.css" as="style" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="preload" href="_static/togglebutton.css" as="style" />
  <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
  <link rel="preload" href="_static/banner.css" as="style" />
  <link rel="stylesheet" href="_static/banner.css" type="text/css" />
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" as="style" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" type="text/css" />
  <link rel="preload" href="_static/katex-math.css" as="style" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
  <link rel="preload" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" as="style" />
  <link rel="stylesheet" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" type="text/css" />
    <link rel="preload" href="_static/css/ignite_theme.css" as="style" />
    <link rel="stylesheet" href="_static/css/ignite_theme.css" type="text/css" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" as="style" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ignite.exceptions" href="exceptions.html" />
    <link rel="prev" title="ignite.handlers" href="handlers.html" /> 

  <!-- katex links / this needs to be loaded before fonts.html -->

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/katex.min.css" crossorigin="anonymous">
<script async src="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/katex.min.js" crossorigin="anonymous"></script>

<!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5FELLLFHCP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5FELLLFHCP');
  </script>
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">

    <a class="header-logo" href="/ignite" aria-label="PyTorch-Ignite"></a>

    <div class="header-container">

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch-ignite.ai/tutorials/beginner/01-getting-started/">Quickstart</a>
          </li>

          <li>
            <a href="https://pytorch-ignite.ai/concepts/">Concepts</a>
          </li>

          <!-- <li>
            <a href="https://pytorch-ignite.ai/tutorials/beginner/01-getting-started/#complete-code">Examples</a>
          </li> -->

          <li>
            <a href="https://pytorch-ignite.ai/how-to-guides/">FAQ</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/ignite" target="_blank" rel="noopener noreferrer">GitHub</a>
          </li>

          <li>
            <a href="https://pytorch-ignite.ai/about/community/">About us</a>
          </li>

          <li>
            <a href="https://pytorch-ignite.ai">‚ä≥ pytorch-ignite.ai</a>
          </li>


        </ul>
      </div>

      <!-- <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a> -->
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <div class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></div>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  v0.3.0
                </div>
              
            

            <div id="docsearch"></div>

            
          </div>

          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="engine.html">ignite.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="handlers.html">ignite.handlers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ignite.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">ignite.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">ignite.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contrib Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contrib/engines.html">ignite.contrib.engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib/metrics.html">ignite.contrib.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib/handlers.html">ignite.contrib.handlers</a></li>
</ul>

            
          
        </div>
      </div>

      <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: v0.3.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="metrics.html">v0.3.0</a></dd>
            <dd><a href="../v0.4.0.post1/metrics.html">v0.4.0.post1</a></dd>
            <dd><a href="../v0.4.1/metrics.html">v0.4.1</a></dd>
            <dd><a href="../v0.4.10/metrics.html">v0.4.10</a></dd>
            <dd><a href="../v0.4.11/metrics.html">v0.4.11</a></dd>
            <dd><a href="../v0.4.12/metrics.html">v0.4.12</a></dd>
            <dd><a href="../v0.4.13/metrics.html">v0.4.13</a></dd>
            <dd><a href="../v0.4.2/metrics.html">v0.4.2</a></dd>
            <dd><a href="../v0.4.3/metrics.html">v0.4.3</a></dd>
            <dd><a href="../v0.4.4.post1/metrics.html">v0.4.4.post1</a></dd>
            <dd><a href="../v0.4.5/metrics.html">v0.4.5</a></dd>
            <dd><a href="../v0.4.6/metrics.html">v0.4.6</a></dd>
            <dd><a href="../v0.4.7/metrics.html">v0.4.7</a></dd>
            <dd><a href="../v0.4.8/metrics.html">v0.4.8</a></dd>
            <dd><a href="../v0.4.9/metrics.html">v0.4.9</a></dd>
            <dd><a href="../v0.4rc.0.post1/metrics.html">v0.4rc.0.post1</a></dd>
            <dd><a href="../v0.5.0.post2/metrics.html">v0.5.0.post2</a></dd>
            <dd><a href="../v0.5.1/metrics.html">v0.5.1</a></dd>
            <dd><a href="../v0.5.2/metrics.html">v0.5.2</a></dd>
            <dd><a href="../v0.5.3/metrics.html">v0.5.3</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../master/metrics.html">master</a></dd>
        </dl>
    </div>
</div>

    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>ignite.metrics</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/metrics.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <section id="ignite-metrics">
<h1>ignite.metrics<a class="headerlink" href="#ignite-metrics" title="Permalink to this heading">#</a></h1>
<p>Metrics provide a way to compute various quantities of interest in an online
fashion without having to store the entire output history of a model.</p>
<p>In practice a user needs to attach the metric instance to an engine. The metric
value is then computed using the output of the engine‚Äôs <cite>process_function</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_function</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="k">return</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>
<span class="n">metric</span> <span class="o">=</span> <span class="n">Accuracy</span><span class="p">()</span>
<span class="n">metric</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the engine‚Äôs output is not in the format <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y, ‚Ä¶}</cite>, the user can
use the <cite>output_transform</cite> argument to transform it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_function</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s1">&#39;y_true&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">output_transform</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="c1"># `output` variable is returned by above `process_function`</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;y_true&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span>  <span class="c1"># output format is according to `Accuracy` docs</span>

<span class="n">metric</span> <span class="o">=</span> <span class="n">Accuracy</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="n">output_transform</span><span class="p">)</span>
<span class="n">metric</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most of implemented metrics are adapted to distributed computations and reduce their internal states across the GPUs
before computing metric value. This can be helpful to run the evaluation on multiple nodes/GPU instances with a
distributed data sampler. Following code snippet shows in detail how to adapt metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">local_rank</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">parallel</span><span class="o">.</span><span class="n">DistributedDataParallel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span>
                                                  <span class="n">device_ids</span><span class="o">=</span><span class="p">[</span><span class="n">local_rank</span><span class="p">,</span> <span class="p">],</span>
                                                  <span class="n">output_device</span><span class="o">=</span><span class="n">local_rank</span><span class="p">)</span>
<span class="n">test_sampler</span> <span class="o">=</span> <span class="n">DistributedSampler</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">sampler</span><span class="o">=</span><span class="n">test_sampler</span><span class="p">,</span>
                         <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">evaluator</span> <span class="o">=</span> <span class="n">create_supervised_evaluator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)},</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="metric-arithmetics">
<h2>Metric arithmetics<a class="headerlink" href="#metric-arithmetics" title="Permalink to this heading">#</a></h2>
<p>Metrics could be combined together to form new metrics. This could be done through arithmetics, such
as <code class="docutils literal notranslate"><span class="pre">metric1</span> <span class="pre">+</span> <span class="pre">metric2</span></code>, use PyTorch operators, such as <code class="docutils literal notranslate"><span class="pre">(metric1</span> <span class="pre">+</span> <span class="pre">metric2).pow(2).mean()</span></code>,
or use a lambda function, such as <code class="docutils literal notranslate"><span class="pre">MetricsLambda(lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">torch.mean(a</span> <span class="pre">+</span> <span class="pre">b),</span> <span class="pre">metric1,</span> <span class="pre">metric2)</span></code>.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">precision</span> <span class="o">=</span> <span class="n">Precision</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">Recall</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">F1</span> <span class="o">=</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example computes the mean of F1 across classes. To combine
precision and recall to get F1 or other F metrics, we have to be careful
that <cite>average=False</cite>, i.e. to use the unaveraged precision and recall,
otherwise we will not be computing F-beta metrics.</p>
</div>
<p>Metrics also support indexing operation (if metric‚Äôs result is a vector/matrix/tensor). For example, this can be useful to compute mean metric (e.g. precision, recall or IoU) ignoring the background:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">ConfusionMatrix</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">iou_metric</span> <span class="o">=</span> <span class="n">IoU</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="n">iou_no_bg_metric</span> <span class="o">=</span> <span class="n">iou_metric</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span>  <span class="c1"># We assume that the background index is 9</span>
<span class="n">mean_iou_no_bg_metric</span> <span class="o">=</span> <span class="n">iou_no_bg_metric</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1"># mean_iou_no_bg_metric.compute() -&gt; tensor(0.12345)</span>
</pre></div>
</div>
</section>
<section id="how-to-create-a-custom-metric">
<h2>How to create a custom metric<a class="headerlink" href="#how-to-create-a-custom-metric" title="Permalink to this heading">#</a></h2>
<p>To create a custom metric one needs to create a new class inheriting from <a class="reference internal" href="#ignite.metrics.Metric" title="ignite.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> and override
three methods :</p>
<ul class="simple">
<li><p><cite>reset()</cite> : resets internal variables and accumulators</p></li>
<li><p><cite>update(output)</cite> : updates internal variables and accumulators with provided batch output <cite>(y_pred, y)</cite></p></li>
<li><p><cite>compute()</cite> : computes custom metric and return the result</p></li>
</ul>
<p>For example, we would like to implement for illustration purposes a multi-class accuracy metric with some
specific condition (e.g. ignore user-defined classes):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ignite.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">Metric</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ignite.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">NotComputableError</span>

<span class="c1"># These decorators helps with distributed settings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ignite.metrics.metric</span><span class="w"> </span><span class="kn">import</span> <span class="n">sync_all_reduce</span><span class="p">,</span> <span class="n">reinit__is_reduced</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CustomAccuracy</span><span class="p">(</span><span class="n">Metric</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignored_class</span><span class="p">,</span> <span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignored_class</span> <span class="o">=</span> <span class="n">ignored_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_correct</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_examples</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CustomAccuracy</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="n">output_transform</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

    <span class="nd">@reinit__is_reduced</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_correct</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_examples</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CustomAccuracy</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="nd">@reinit__is_reduced</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
        <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">output</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignored_class</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">indices</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignored_class</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_correct</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_examples</span> <span class="o">+=</span> <span class="n">correct</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@sync_all_reduce</span><span class="p">(</span><span class="s2">&quot;_num_examples&quot;</span><span class="p">,</span> <span class="s2">&quot;_num_correct&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_examples</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotComputableError</span><span class="p">(</span><span class="s1">&#39;CustomAccuracy must have at least one example before it can be computed.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_correct</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_examples</span>
</pre></div>
</div>
<p>We imported necessary classes as <a class="reference internal" href="#ignite.metrics.Metric" title="ignite.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>, <a class="reference internal" href="exceptions.html#ignite.exceptions.NotComputableError" title="ignite.exceptions.NotComputableError"><code class="xref py py-class docutils literal notranslate"><span class="pre">NotComputableError</span></code></a> and
decorators to adapt the metric for distributed setting. In <cite>reset</cite> method, we reset internal variables <cite>_num_correct</cite>
and <cite>_num_examples</cite> which are used to compute the custom metric. In <cite>updated</cite> method we define how to update
the internal variables. And finally in <cite>compute</cite> method, we compute metric value.</p>
<p>We can check this implementation in a simple case:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">CustomAccuracy</span><span class="p">(</span><span class="n">ignored_class</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="p">))</span>

<span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># Out: tensor([2, 2, 2, 3]) tensor([2, 1, 0, 0])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">_num_correct</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">_num_examples</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
<span class="c1"># Out: 1 3 0.3333333333333333</span>
</pre></div>
</div>
<section id="metrics-and-distributed-computations">
<h3>Metrics and distributed computations<a class="headerlink" href="#metrics-and-distributed-computations" title="Permalink to this heading">#</a></h3>
<p>In the above example, <cite>CustomAccuracy</cite> constructor has <cite>device</cite> argument and <cite>reset</cite>, <cite>update</cite>, <cite>compute</cite> methods are decorated with <cite>reinit__is_reduced</cite>, <cite>sync_all_reduce</cite>. The purpose of these features is to adapt metrics in distributed computations on CUDA devices and assuming the backend to support <a class="reference external" href="https://pytorch.org/docs/stable/distributed.html#torch.distributed.all_reduce">‚Äúall_reduce‚Äù operation</a>. User can specify the device (by default, <cite>cuda</cite>) at metric‚Äôs initialization. This device _can_ be used to store internal variables on and to collect all results from all participating devices. More precisely, in the above example we added <cite>&#64;sync_all_reduce(‚Äú_num_examples‚Äù, ‚Äú_num_correct‚Äù)</cite> over <cite>compute</cite> method. This means that when <cite>compute</cite> method is called, metric‚Äôs interal variables <cite>self._num_examples</cite> and <cite>self._num_correct</cite> are summed up over all participating devices. Therefore, once collected, these internal variables can be used to compute the final metric value.</p>
</section>
</section>
<section id="complete-list-of-metrics">
<h2>Complete list of metrics<a class="headerlink" href="#complete-list-of-metrics" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#ignite.metrics.Accuracy" title="ignite.metrics.Accuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Accuracy</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.Average" title="ignite.metrics.Average"><code class="xref py py-class docutils literal notranslate"><span class="pre">Average</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.ConfusionMatrix" title="ignite.metrics.ConfusionMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfusionMatrix</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.DiceCoefficient" title="ignite.metrics.DiceCoefficient"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DiceCoefficient()</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.EpochMetric" title="ignite.metrics.EpochMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochMetric</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.Fbeta" title="ignite.metrics.Fbeta"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Fbeta()</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.GeometricAverage" title="ignite.metrics.GeometricAverage"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricAverage</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.IoU" title="ignite.metrics.IoU"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IoU()</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.mIoU" title="ignite.metrics.mIoU"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mIoU()</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.Loss" title="ignite.metrics.Loss"><code class="xref py py-class docutils literal notranslate"><span class="pre">Loss</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.MeanAbsoluteError" title="ignite.metrics.MeanAbsoluteError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeanAbsoluteError</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.MeanPairwiseDistance" title="ignite.metrics.MeanPairwiseDistance"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeanPairwiseDistance</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.MeanSquaredError" title="ignite.metrics.MeanSquaredError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeanSquaredError</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.Metric" title="ignite.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.MetricsLambda" title="ignite.metrics.MetricsLambda"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetricsLambda</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.Precision" title="ignite.metrics.Precision"><code class="xref py py-class docutils literal notranslate"><span class="pre">Precision</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.Recall" title="ignite.metrics.Recall"><code class="xref py py-class docutils literal notranslate"><span class="pre">Recall</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.RootMeanSquaredError" title="ignite.metrics.RootMeanSquaredError"><code class="xref py py-class docutils literal notranslate"><span class="pre">RootMeanSquaredError</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.RunningAverage" title="ignite.metrics.RunningAverage"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunningAverage</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.TopKCategoricalAccuracy" title="ignite.metrics.TopKCategoricalAccuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopKCategoricalAccuracy</span></code></a></p></li>
<li><p><a class="reference internal" href="#ignite.metrics.VariableAccumulation" title="ignite.metrics.VariableAccumulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableAccumulation</span></code></a></p></li>
</ul>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.Accuracy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">Accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Accuracy.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_multilabel=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/accuracy.html#Accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Accuracy" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the accuracy for binary, multiclass and multilabel data.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
<li><p><cite>y_pred</cite> must be in the following shape (batch_size, num_categories, ‚Ä¶) or (batch_size, ‚Ä¶).</p></li>
<li><p><cite>y</cite> must be in the following shape (batch_size, ‚Ä¶).</p></li>
<li><p><cite>y</cite> and <cite>y_pred</cite> must be in the following shape of (batch_size, num_categories, ‚Ä¶) for multilabel cases.</p></li>
</ul>
<p>In binary and multilabel cases, the elements of <cite>y</cite> and <cite>y_pred</cite> should have 0 or 1 values. Thresholding of
predictions can be done as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">thresholded_output_transform</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">output</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span>

<span class="n">binary_accuracy</span> <span class="o">=</span> <span class="n">Accuracy</span><span class="p">(</span><span class="n">thresholded_output_transform</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
<li><p><strong>is_multilabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) ‚Äì flag to use in multilabel case. By default, False.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.Average">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">Average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Average.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/accumulation.html#Average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Average" title="Permalink to this definition">#</a></dt>
<dd><p>Helper class to compute arithmetic average of a single variable.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>x</cite>.</p></li>
<li><p><cite>x</cite> can be a number or <cite>torch.Tensor</cite>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Number of samples is updated following the rule:</p>
<ul class="simple">
<li><p><cite>+1</cite> if input is a number</p></li>
<li><p><cite>+1</cite> if input is a 1D <cite>torch.Tensor</cite></p></li>
<li><p><cite>+batch_size</cite> if input is an ND <cite>torch.Tensor</cite>. Batch size is the first dimension (<cite>shape[0]</cite>).</p></li>
</ul>
<p>For input <cite>x</cite> being an ND <cite>torch.Tensor</cite> with N &gt; 1, the first dimension is seen as the number of samples and
is summed up and added to the accumulator: <cite>accumulator += x.sum(dim=0)</cite></p>
</div>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">evaluator</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">custom_var_mean</span> <span class="o">=</span> <span class="n">Average</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">output</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;custom_var&#39;</span><span class="p">])</span>
<span class="n">custom_var_mean</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">evaluator</span><span class="p">,</span> <span class="s1">&#39;mean_custom_var&#39;</span><span class="p">)</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="c1"># state.metrics[&#39;mean_custom_var&#39;] -&gt; average of output[&#39;custom_var&#39;]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it should defined as ‚Äúcuda:local_rank‚Äù.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.ConfusionMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">ConfusionMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">ConfusionMatrix.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/confusion_matrix.html#ConfusionMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.ConfusionMatrix" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates confusion matrix for multi-class data.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
<li><p><cite>y_pred</cite> must contain logits and has the following shape (batch_size, num_categories, ‚Ä¶)</p></li>
<li><dl class="simple">
<dt><cite>y</cite> should have the following shape (batch_size, ‚Ä¶) and contains ground-truth class indices</dt><dd><p>with or without the background class. During the computation, argmax of <cite>y_pred</cite> is taken to determine
predicted classes.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) ‚Äì number of classes. See notes for more details.</p></li>
<li><p><strong>average</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) ‚Äì confusion matrix values averaging schema: None, ‚Äúsamples‚Äù, ‚Äúrecall‚Äù, ‚Äúprecision‚Äù.
Default is None. If <cite>average=‚Äùsamples‚Äù</cite> then confusion matrix values are normalized by the number of seen
samples. If <cite>average=‚Äùrecall‚Äù</cite> then confusion matrix values are normalized such that diagonal values
represent class recalls. If <cite>average=‚Äùprecision‚Äù</cite> then confusion matrix values are normalized such that
diagonal values represent class precisions.</p></li>
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case of the targets <cite>y</cite> in <cite>(batch_size, ‚Ä¶)</cite> format, target indices between 0 and <cite>num_classes</cite> only
contribute to the confusion matrix and others are neglected. For example, if <cite>num_classes=20</cite> and target index
equal 255 is encountered, then it is filtered out.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ignite.metrics.DiceCoefficient">
<span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">DiceCoefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/confusion_matrix.html#DiceCoefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.DiceCoefficient" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates Dice Coefficient for a given <a class="reference internal" href="#ignite.metrics.ConfusionMatrix" title="ignite.metrics.ConfusionMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfusionMatrix</span></code></a> metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cm</strong> (<a class="reference internal" href="#ignite.metrics.ConfusionMatrix" title="ignite.metrics.ConfusionMatrix"><em>ConfusionMatrix</em></a>) ‚Äì instance of confusion matrix metric</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) ‚Äì index to ignore, e.g. background index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.EpochMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">EpochMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">EpochMetric.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/epoch_metric.html#EpochMetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.EpochMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Class for metrics that should be computed on the entire output history of a model.
Model‚Äôs output and targets are restricted to be of shape <cite>(batch_size, n_classes)</cite>. Output
datatype should be <cite>float32</cite>. Target datatype should be <cite>long</cite>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Current implementation stores all input data (output and target) in as tensors before computing a metric.
This can potentially lead to a memory error if the input data is larger than available RAM.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Current implementation does not work with distributed computations. Results are not gather across all devices
and computed results are valid for a single device only.</p>
</div>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
</ul>
<p>If target shape is <cite>(batch_size, n_classes)</cite> and <cite>n_classes &gt; 1</cite> than it should be binary: e.g. <cite>[[0, 1, 0, 1], ]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compute_fn</strong> (<em>callable</em>) ‚Äì a callable with the signature (<cite>torch.tensor</cite>, <cite>torch.tensor</cite>) takes as the input
<cite>predictions</cite> and <cite>targets</cite> and returns a scalar.</p></li>
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ignite.metrics.Fbeta">
<span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">Fbeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/fbeta.html#Fbeta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Fbeta" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates F-beta score</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) ‚Äì weight of precision in harmonic mean</p></li>
<li><p><strong>average</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) ‚Äì if True, F-beta score is computed as the unweighted average (across all classes
in multiclass case), otherwise, returns a tensor with F-beta score for each class in multiclass case.</p></li>
<li><p><strong>precision</strong> (<a class="reference internal" href="#ignite.metrics.Precision" title="ignite.metrics.Precision"><em>Precision</em></a><em>, </em><em>optional</em>) ‚Äì precision object metric with <cite>average=False</cite> to compute F-beta score</p></li>
<li><p><strong>recall</strong> (<a class="reference internal" href="#ignite.metrics.Precision" title="ignite.metrics.Precision"><em>Precision</em></a><em>, </em><em>optional</em>) ‚Äì recall object metric with <cite>average=False</cite> to compute F-beta score</p></li>
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. It is used only if precision or recall are not provided.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MetricsLambda, F-beta metric</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.GeometricAverage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">GeometricAverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">GeometricAverage.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/accumulation.html#GeometricAverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.GeometricAverage" title="Permalink to this definition">#</a></dt>
<dd><p>Helper class to compute geometric average of a single variable.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>x</cite>.</p></li>
<li><p><cite>x</cite> can be a number or <cite>torch.Tensor</cite>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Number of samples is updated following the rule:</p>
<ul class="simple">
<li><p><cite>+1</cite> if input is a number</p></li>
<li><p><cite>+1</cite> if input is a 1D <cite>torch.Tensor</cite></p></li>
<li><p><cite>+batch_size</cite> if input is a ND <cite>torch.Tensor</cite>. Batch size is the first dimension (<cite>shape[0]</cite>).</p></li>
</ul>
<p>For input <cite>x</cite> being an ND <cite>torch.Tensor</cite> with N &gt; 1, the first dimension is seen as the number of samples and
is aggregated and added to the accumulator: <cite>accumulator *= prod(x, dim=0)</cite></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it should defined as ‚Äúcuda:local_rank‚Äù.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ignite.metrics.IoU">
<span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">IoU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/confusion_matrix.html#IoU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.IoU" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates Intersection over Union using <a class="reference internal" href="#ignite.metrics.ConfusionMatrix" title="ignite.metrics.ConfusionMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfusionMatrix</span></code></a> metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cm</strong> (<a class="reference internal" href="#ignite.metrics.ConfusionMatrix" title="ignite.metrics.ConfusionMatrix"><em>ConfusionMatrix</em></a>) ‚Äì instance of confusion matrix metric</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) ‚Äì index to ignore, e.g. background index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MetricsLambda</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_evaluator</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">ConfusionMatrix</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span>
<span class="n">IoU</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">train_evaluator</span><span class="p">,</span> <span class="s1">&#39;IoU&#39;</span><span class="p">)</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">train_evaluator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
<span class="c1"># state.metrics[&#39;IoU&#39;] -&gt; tensor of shape (num_classes - 1, )</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ignite.metrics.mIoU">
<span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">mIoU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/confusion_matrix.html#mIoU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.mIoU" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates mean Intersection over Union using <a class="reference internal" href="#ignite.metrics.ConfusionMatrix" title="ignite.metrics.ConfusionMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfusionMatrix</span></code></a> metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cm</strong> (<a class="reference internal" href="#ignite.metrics.ConfusionMatrix" title="ignite.metrics.ConfusionMatrix"><em>ConfusionMatrix</em></a>) ‚Äì instance of confusion matrix metric</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) ‚Äì index to ignore, e.g. background index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MetricsLambda</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_evaluator</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">ConfusionMatrix</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span>
<span class="n">mIoU</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">train_evaluator</span><span class="p">,</span> <span class="s1">&#39;mean IoU&#39;</span><span class="p">)</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">train_evaluator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
<span class="c1"># state.metrics[&#39;mean IoU&#39;] -&gt; scalar</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.Loss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">Loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Loss.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=&lt;function</span> <span class="pre">Loss.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/loss.html#Loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Loss" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the average loss according to the passed loss_fn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_fn</strong> (<em>callable</em>) ‚Äì a callable taking a prediction tensor, a target
tensor, optionally other arguments, and returns the average loss
over all observations in the batch.</p></li>
<li><p><strong>output_transform</strong> (<em>callable</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric.
This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.
The output is expected to be a tuple <cite>(prediction, target)</cite> or
(prediction, target, kwargs) where kwargs is a dictionary of extra
keywords arguments. If extra keywords arguments are provided they are passed to <cite>loss_fn</cite>.</p></li>
<li><p><strong>batch_size</strong> (<em>callable</em>) ‚Äì a callable taking a target tensor that returns the
first dimension size (usually the batch size).</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.MeanAbsoluteError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">MeanAbsoluteError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Metric.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/mean_absolute_error.html#MeanAbsoluteError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.MeanAbsoluteError" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the mean absolute error.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.MeanPairwiseDistance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">MeanPairwiseDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps=1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">MeanPairwiseDistance.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/mean_pairwise_distance.html#MeanPairwiseDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.MeanPairwiseDistance" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the mean pairwise distance: average of pairwise distances computed on provided batches.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.MeanSquaredError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">MeanSquaredError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Metric.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/mean_squared_error.html#MeanSquaredError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.MeanSquaredError" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the mean squared error.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.Metric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">Metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Metric.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/metric.html#Metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Metric" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all Metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.
By default, metrics require the output as <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ignite.metrics.Metric.compute">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/metric.html#Metric.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Metric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the metric based on it‚Äôs accumulated state.</p>
<p>This is called at the end of each epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the actual quantity of interest.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Any</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="exceptions.html#ignite.exceptions.NotComputableError" title="ignite.exceptions.NotComputableError"><strong>NotComputableError</strong></a> ‚Äì raised when the metric cannot be computed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ignite.metrics.Metric.reset">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/metric.html#Metric.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Metric.reset" title="Permalink to this definition">#</a></dt>
<dd><p>Resets the metric to it‚Äôs initial state.</p>
<p>This is called at the start of each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ignite.metrics.Metric.update">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/metric.html#Metric.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Metric.update" title="Permalink to this definition">#</a></dt>
<dd><p>Updates the metric‚Äôs state using the passed batch output.</p>
<p>This is called once for each batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output</strong> ‚Äì the is the output from the engine‚Äôs process function.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.MetricsLambda">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">MetricsLambda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/metrics_lambda.html#MetricsLambda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.MetricsLambda" title="Permalink to this definition">#</a></dt>
<dd><p>Apply a function to other metrics to obtain a new metric.
The result of the new metric is defined to be the result
of applying the function to the result of argument metrics.</p>
<p>When update, this metric does not recursively update the metrics
it depends on. When reset, all its dependency metrics would be
resetted. When attach, all its dependencies would be automatically
attached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>callable</em>) ‚Äì the function that defines the computation</p></li>
<li><p><strong>args</strong> (<em>sequence</em>) ‚Äì Sequence of other metrics or something
else that will be fed to <code class="docutils literal notranslate"><span class="pre">f</span></code> as arguments.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">precision</span> <span class="o">=</span> <span class="n">Precision</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">Recall</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">Fbeta</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="mf">1e-20</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="n">F1</span> <span class="o">=</span> <span class="n">MetricsLambda</span><span class="p">(</span><span class="n">Fbeta</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">F2</span> <span class="o">=</span> <span class="n">MetricsLambda</span><span class="p">(</span><span class="n">Fbeta</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">F3</span> <span class="o">=</span> <span class="n">MetricsLambda</span><span class="p">(</span><span class="n">Fbeta</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">F4</span> <span class="o">=</span> <span class="n">MetricsLambda</span><span class="p">(</span><span class="n">Fbeta</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.Precision">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">Precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Precision.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_multilabel=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/precision.html#Precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Precision" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates precision for binary and multiclass data.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
<li><p><cite>y_pred</cite> must be in the following shape (batch_size, num_categories, ‚Ä¶) or (batch_size, ‚Ä¶).</p></li>
<li><p><cite>y</cite> must be in the following shape (batch_size, ‚Ä¶).</p></li>
</ul>
<p>In binary and multilabel cases, the elements of <cite>y</cite> and <cite>y_pred</cite> should have 0 or 1 values. Thresholding of
predictions can be done as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">thresholded_output_transform</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">output</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span>

<span class="n">precision</span> <span class="o">=</span> <span class="n">Precision</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="n">thresholded_output_transform</span><span class="p">)</span>
</pre></div>
</div>
<p>In multilabel cases, average parameter should be True. However, if user would like to compute F1 metric, for
example, average parameter should be False. This can be done as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">precision</span> <span class="o">=</span> <span class="n">Precision</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_multilabel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">Recall</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_multilabel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">+</span> <span class="mf">1e-20</span><span class="p">)</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">MetricsLambda</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">F1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In multilabel cases, if average is False, current implementation stores all input data (output and target) in
as tensors before computing a metric. This can potentially lead to a memory error if the input data is larger
than available RAM.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In multilabel cases, if average is False, current implementation does not work with distributed computations.
Results are not reduced across the GPUs. Computed result corresponds to the local rank‚Äôs (single GPU) result.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
<li><p><strong>average</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) ‚Äì if True, precision is computed as the unweighted average (across all classes
in multiclass case), otherwise, returns a tensor with the precision (for each class in multiclass case).</p></li>
<li><p><strong>is_multilabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) ‚Äì parameter should be True and the average is computed across samples, instead of classes.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.Recall">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">Recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Recall.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_multilabel=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/recall.html#Recall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.Recall" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates recall for binary and multiclass data.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
<li><p><cite>y_pred</cite> must be in the following shape (batch_size, num_categories, ‚Ä¶) or (batch_size, ‚Ä¶).</p></li>
<li><p><cite>y</cite> must be in the following shape (batch_size, ‚Ä¶).</p></li>
</ul>
<p>In binary and multilabel cases, the elements of <cite>y</cite> and <cite>y_pred</cite> should have 0 or 1 values. Thresholding of
predictions can be done as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">thresholded_output_transform</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">output</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span>

<span class="n">recall</span> <span class="o">=</span> <span class="n">Recall</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="n">thresholded_output_transform</span><span class="p">)</span>
</pre></div>
</div>
<p>In multilabel cases, average parameter should be True. However, if user would like to compute F1 metric, for
example, average parameter should be False. This can be done as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">precision</span> <span class="o">=</span> <span class="n">Precision</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_multilabel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">Recall</span><span class="p">(</span><span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_multilabel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">+</span> <span class="mf">1e-20</span><span class="p">)</span>
<span class="n">F1</span> <span class="o">=</span> <span class="n">MetricsLambda</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">F1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In multilabel cases, if average is False, current implementation stores all input data (output and target) in
as tensors before computing a metric. This can potentially lead to a memory error if the input data is larger
than available RAM.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In multilabel cases, if average is False, current implementation does not work with distributed computations.
Results are not reduced across the GPUs. Computed result corresponds to the local rank‚Äôs (single GPU) result.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
<li><p><strong>average</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) ‚Äì if True, precision is computed as the unweighted average (across all classes
in multiclass case), otherwise, returns a tensor with the precision (for each class in multiclass case).</p></li>
<li><p><strong>is_multilabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) ‚Äì parameter should be True and the average is computed across samples, instead of classes.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.RootMeanSquaredError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">RootMeanSquaredError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">Metric.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/root_mean_squared_error.html#RootMeanSquaredError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.RootMeanSquaredError" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the root mean squared error.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form (y_pred, y) or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.RunningAverage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">RunningAverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/running_average.html#RunningAverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.RunningAverage" title="Permalink to this definition">#</a></dt>
<dd><p>Compute running average of a metric or the output of process function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<a class="reference internal" href="#ignite.metrics.Metric" title="ignite.metrics.Metric"><em>Metric</em></a><em> or </em><em>None</em>) ‚Äì input source: an instance of <a class="reference internal" href="#ignite.metrics.Metric" title="ignite.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> or None. The latter
corresponds to <cite>engine.state.output</cite> which holds the output of process function.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) ‚Äì running average decay factor, default 0.98</p></li>
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a function to use to transform the output if <cite>src</cite> is None and
corresponds the output of process function. Otherwise it should be None.</p></li>
<li><p><strong>epoch_bound</strong> (<em>boolean</em><em>, </em><em>optional</em>) ‚Äì whether the running average should be reset after each epoch (defaults
to True).</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
This is necessary when running average is computed on the output of process function.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.98</span>
<span class="n">acc_metric</span> <span class="o">=</span> <span class="n">RunningAverage</span><span class="p">(</span><span class="n">Accuracy</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">acc_metric</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="s1">&#39;running_avg_accuracy&#39;</span><span class="p">)</span>

<span class="n">avg_output</span> <span class="o">=</span> <span class="n">RunningAverage</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">avg_output</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="s1">&#39;running_avg_loss&#39;</span><span class="p">)</span>

<span class="nd">@trainer</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_COMPLETED</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">log_running_avg_metrics</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;running avg accuracy:&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;running_avg_accuracy&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;running avg loss:&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;running_avg_loss&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.TopKCategoricalAccuracy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">TopKCategoricalAccuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k=5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">TopKCategoricalAccuracy.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/top_k_categorical_accuracy.html#TopKCategoricalAccuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.TopKCategoricalAccuracy" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the top-k categorical accuracy.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>(y_pred, y)</cite> or <cite>{‚Äòy_pred‚Äô: y_pred, ‚Äòy‚Äô: y}</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ignite.metrics.VariableAccumulation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ignite.metrics.</span></span><span class="sig-name descname"><span class="pre">VariableAccumulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_transform=&lt;function</span> <span class="pre">VariableAccumulation.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/metrics/accumulation.html#VariableAccumulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ignite.metrics.VariableAccumulation" title="Permalink to this definition">#</a></dt>
<dd><p>Single variable accumulator helper to compute (arithmetic, geometric, harmonic) average of a single variable.</p>
<ul class="simple">
<li><p><cite>update</cite> must receive output of the form <cite>x</cite>.</p></li>
<li><p><cite>x</cite> can be a number or <cite>torch.Tensor</cite>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The class stores input into two public variables: <cite>accumulator</cite> and <cite>num_examples</cite>.
Number of samples is updated following the rule:</p>
<ul class="simple">
<li><p><cite>+1</cite> if input is a number</p></li>
<li><p><cite>+1</cite> if input is a 1D <cite>torch.Tensor</cite></p></li>
<li><p><cite>+batch_size</cite> if input is a ND <cite>torch.Tensor</cite>. Batch size is the first dimension (<cite>shape[0]</cite>).</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>op</strong> (<em>callable</em>) ‚Äì a callable to update accumulator. Method‚Äôs signature is <cite>(accumulator, output)</cite>.
For example, to compute arithmetic mean value, <cite>op = lambda a, x: a + x</cite>.</p></li>
<li><p><strong>output_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) ‚Äì a callable that is used to transform the
<a class="reference internal" href="engine.html#ignite.engine.Engine" title="ignite.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>‚Äôs <cite>process_function</cite>‚Äôs output into the
form expected by the metric. This can be useful if, for example, you have a multi-output model and
you want to compute the metric with respect to one of the outputs.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a><em>, </em><em>optional</em>) ‚Äì device specification in case of distributed computation usage.
In most of the cases, it can be defined as ‚Äúcuda:local_rank‚Äù or ‚Äúcuda‚Äù
if already set <cite>torch.cuda.set_device(local_rank)</cite>. By default, if a distributed process group is
initialized and available, device is set to <cite>cuda</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="exceptions.html" class="btn btn-neutral float-right" title="ignite.exceptions" accesskey="n" rel="next">Next
          <img src="_static/images/chevron-right-orange.svg" alt="right arrow" class="next-page">
        </a>
      
      
        <a href="handlers.html" class="btn btn-neutral" title="ignite.handlers" accesskey="p" rel="prev">
          <img src="_static/images/chevron-right-orange.svg" alt="left arrow" class="previous-page"> Previous
        </a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <table>
      <tr>
        <td>
            <p>
                &copy; Copyright 2025, PyTorch-Ignite Contributors.
              Last updated on 01/21/2020, 9:14:40‚ÄØPM.
            </p>
            
              <div>
                Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
              </div>
          
        </td>
        <td>
            
              <div>
                <a href="https://www.netlify.com" target="_blank" rel="noopener noreferrer">
                  <img
                  src="_static/img/netlify-light.svg"
                  alt="Deploys by Netlify"
                  width=114
                  height=51 />
                </a>
              </div>
            
        </td>
      </tr>
    </table>
  </div> 

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">ignite.metrics</a><ul>
<li><a class="reference internal" href="#metric-arithmetics">Metric arithmetics</a></li>
<li><a class="reference internal" href="#how-to-create-a-custom-metric">How to create a custom metric</a><ul>
<li><a class="reference internal" href="#metrics-and-distributed-computations">Metrics and distributed computations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#complete-list-of-metrics">Complete list of metrics</a><ul>
<li><a class="reference internal" href="#ignite.metrics.Accuracy"><code class="docutils literal notranslate"><span class="pre">Accuracy</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Average"><code class="docutils literal notranslate"><span class="pre">Average</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.ConfusionMatrix"><code class="docutils literal notranslate"><span class="pre">ConfusionMatrix</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.DiceCoefficient"><code class="docutils literal notranslate"><span class="pre">DiceCoefficient()</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.EpochMetric"><code class="docutils literal notranslate"><span class="pre">EpochMetric</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Fbeta"><code class="docutils literal notranslate"><span class="pre">Fbeta()</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.GeometricAverage"><code class="docutils literal notranslate"><span class="pre">GeometricAverage</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.IoU"><code class="docutils literal notranslate"><span class="pre">IoU()</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.mIoU"><code class="docutils literal notranslate"><span class="pre">mIoU()</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Loss"><code class="docutils literal notranslate"><span class="pre">Loss</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.MeanAbsoluteError"><code class="docutils literal notranslate"><span class="pre">MeanAbsoluteError</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.MeanPairwiseDistance"><code class="docutils literal notranslate"><span class="pre">MeanPairwiseDistance</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.MeanSquaredError"><code class="docutils literal notranslate"><span class="pre">MeanSquaredError</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Metric"><code class="docutils literal notranslate"><span class="pre">Metric</span></code></a><ul>
<li><a class="reference internal" href="#ignite.metrics.Metric.compute"><code class="docutils literal notranslate"><span class="pre">Metric.compute()</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Metric.reset"><code class="docutils literal notranslate"><span class="pre">Metric.reset()</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Metric.update"><code class="docutils literal notranslate"><span class="pre">Metric.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#ignite.metrics.MetricsLambda"><code class="docutils literal notranslate"><span class="pre">MetricsLambda</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Precision"><code class="docutils literal notranslate"><span class="pre">Precision</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.Recall"><code class="docutils literal notranslate"><span class="pre">Recall</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.RootMeanSquaredError"><code class="docutils literal notranslate"><span class="pre">RootMeanSquaredError</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.RunningAverage"><code class="docutils literal notranslate"><span class="pre">RunningAverage</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.TopKCategoricalAccuracy"><code class="docutils literal notranslate"><span class="pre">TopKCategoricalAccuracy</span></code></a></li>
<li><a class="reference internal" href="#ignite.metrics.VariableAccumulation"><code class="docutils literal notranslate"><span class="pre">VariableAccumulation</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="_static/sphinx_highlight.js"></script>
         <script src="_static/clipboard.min.js"></script>
         <script src="_static/copybutton.js"></script>
         <script>let toggleHintShow = 'Show default setup';</script>
         <script>let toggleHintHide = 'Hide default setup';</script>
         <script>let toggleOpenOnPrint = 'true';</script>
         <script src="_static/togglebutton.js"></script>
         <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
         <script src="_static/design-tabs.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <!-- commented out for Ignite -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <!-- <div class="container">
      <div class="row">
        <div class="text-center col-md-4">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/ignite/index.html">View Docs</a>
        </div>

        <div class="text-center col-md-4">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="">View Tutorials</a>
        </div>

        <div class="text-center col-md-4">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="">View Resources</a>
        </div>
      </div>
    </div> -->
  </div>

  <!-- <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch-ignite.ai" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch-ignite.ai">PyTorch</a></li>
            <li><a href="">Get Started</a></li>
            <li><a href="">Features</a></li>
            <li><a href="">Ecosystem</a></li>
            <li><a href="">Blog</a></li>
            <li><a href="">Resources</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Support</a></li>
            <li><a href="">Tutorials</a></li>
            <li><a href="https://pytorch.org/ignite/index.html">Docs</a></li>
            <li><a href="" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/ignite/issues" target="_blank">Github Issues</a></li>
            <li><a href="" target="_blank">Slack</a></li>
            <li><a href="https://github.com/pytorch/ignite/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!~~ real people should not fill this in and expect good things - do not remove this or risk form bot signups ~~>

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="" target="_blank" class="facebook"></a>
            <a href="" target="_blank" class="twitter"></a>
          </div>
        </div>
      </div>
    </div>
  </footer> -->


  <!-- end of commented out for Ignite -->

  <!-- <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook‚Äôs Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div> -->

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->
  <!--
  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch-ignite.ai" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="#">Get Started</a>
          </li>

          <li>
            <a href="#">Features</a>
          </li>

          <li>
            <a href="#">Ecosystem</a>
          </li>

          <li>
            <a href="">Blog</a>
          </li>

          <li>
            <a href="">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorch.org/ignite/index.html">Docs</a>
          </li>

          <li>
            <a href="">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/ignite">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  -->
  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    var collapsedSections = []
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
  let VERSION
  if ('v0.3.0'.startsWith('v')) {
    VERSION = 'v0.3.0'
  } else {
    VERSION = 'master'
  }
  docsearch({
    container: '#docsearch',
    appId: '7EWYE1JCT3',
    apiKey: '841e93e60c16975ba1bd8c7c716eed82',
    indexName: 'pytorch-ignite',
    placeholder: 'Search PyTorch-Ignite docs',
    searchParameters: {
      facetFilters: [`version:${VERSION}`, 'tags:API-reference'],
    }
  });
  </script>
</body>
</html>